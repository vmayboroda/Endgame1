#include "arcanoid.h"

void fail(char *msg) {
     endwin();
     puts(msg);
     exit(EXIT_FAILURE);
}

void highlight(WINDOW *win, int x, int y, bool on)
{
    wattron(win, COLOR_PAIR(on ? 9 : 8));
    for (int i = 0; i < 14; i++)
    {
        mvwprintw(win, y + i - 3, x - 20, " ");
        mvwprintw(win, y + i - 3, x + 110, " ");
    }

    for (int i = 0; i < 5; i++)
    {
        for (int j = 0; j < i * i; j++)
        {
            mvwprintw(win, y + 1 - i, x - 19 + j, " ");
            mvwprintw(win, y + 6 + i, x - 19 + j, " ");
            mvwprintw(win, y + 1 - i, x + 109 - j, " ");
            mvwprintw(win, y + 6 + i, x + 109 - j, " ");
        }
    }
    wattroff(win, COLOR_PAIR(on ? 9 : 8));
}

void drawStart(WINDOW *win, int x, int y, bool highlighted)
{
    char *symbols[8] = {
        " _______  _________  _______   ________  _________    _______   _______   _______   _______",
        "( ____ \\  \\__   __/ (  ___  ) (  ____  ) \\__   __/   (  ____ \\ (  ___  ) (       ) (  ____ \\",
        "| (    \\/    ) (    | (   ) | | (    ) |    ) (      | (    \\/ | (   ) | | /\\ /\\ | | (    \\/",
        "| (_____     | |    | (___) | | (____) |    | |      | |       | (___) | | || || | | (__    ",
        "(_____  )    | |    |  ___  | |     ___)    | |      | | ____  |  ___  | | | V | | |  __)   ",
        "      ) |    | |    | (   ) | | (\\ (        | |      | | \\_  ) | (   ) | | |   | | | (      ",
        "/\\____) |    | |    | )   ( | | ) \\ \\__     | |      | (___) | | )   ( | | )   ( | | (____/\\",
        "\\_______)    )_(    |/     \\| |/   \\__/     )_(      (_______) |/     \\| |/     \\| (_______/"
    };

    for (int i = 0; i < 8; i++)
    {
        for (unsigned long j = 0; j < strlen(symbols[i]); j++)
        {
            wattron(win, COLOR_PAIR(8));
            mvwprintw(win, y + i, x + j, "%c", symbols[i][j]);
            wattroff(win, COLOR_PAIR(8));
        }
    }
    if (highlighted) 
    {
        highlight(win, x, y, true);
        highlight(win, x, y + 14, false);
        highlight(win, x, y + 28, false);
    }
}

void drawInfo(WINDOW *win, int x, int y, bool highlighted)
{
    char *symbols[8] = {
        " _______   ______    _______            _________              _______ ",
        "(  ___  ) (  ___ \\  (  ___  ) |\\     /| \\__   __/   |\\     /| (  ____ \\",
        "| (   ) | | (   ) ) | (   ) | | )   ( |    ) (      | )   ( | | (    \\/",
        "| (___) | | (__/ /  | |   | | | |   | |    | |      | |   | | | (_____ ",
        "|  ___  | |  __ (   | |   | | | |   | |    | |      | |   | | (_____  )",
        "| (   ) | | (  \\ \\  | |   | | | |   | |    | |      | |   | |       ) |",
        "| )   ( | | )___) ) | (___) | | (___) |    | |      | (___) | /\\____) |",
        "|/     \\| |/ \\___/  (_______) (_______)    )_(      (_______) \\_______)"
    };

    for (int i = 0; i < 8; i++)
    {
        for (unsigned long j = 0; j < strlen(symbols[i]); j++)
        {
            wattron(win, COLOR_PAIR(8));
            mvwprintw(win, y + i, x + 10 + j, "%c", symbols[i][j]);
            wattroff(win, COLOR_PAIR(8));
        }
    }
    if (highlighted) 
    {
        highlight(win, x, y - 14, false);
        highlight(win, x, y, true);
        highlight(win, x, y + 14, false);
    }
}

void drawQuit(WINDOW *win, int x, int y, bool highlighted)
{
    char *symbols[8] = {
        " _______            _________ _________",
        "(  ___  ) |\\     /| \\__   __/ \\__   __/",
        "| (   ) | | )   ( |    ) (       ) (   ",
        "| |   | | | |   | |    | |       | |   ",
        "| |   | | | |   | |    | |       | |   ",
        "| | /\\| | | |   | |    | |       | |   ",
        "| (_\\ \\ | | (___) | ___) (___    | |   ",
        "(____\\/_) (_______) \\_______/    )_(   "
    };

    for (int i = 0; i < 8; i++)
    {
        for (unsigned long j = 0; j < strlen(symbols[i]); j++)
        {
            wattron(win, COLOR_PAIR(8));
            mvwprintw(win, y + i, x + 26 + j, "%c", symbols[i][j]);
            wattroff(win, COLOR_PAIR(8));
        }
    }
    if (highlighted) 
    {
        highlight(win, x, y - 28, false);
        highlight(win, x, y - 14, false);
        highlight(win, x, y, true);
    }
}

void outputInfo(WINDOW *win, int maxX, int maxY)
{
    char *text[4][8] = 
	{
		{
			" ___      ___ _____ ______   ________  ___  ________  ________  ________  ________  ________  ________     ",
			"|\\  \\    /  /|\\   _ \\  _   \\|\\   __  \\|\\  \\|\\   __  \\|\\   __  \\|\\   __  \\|\\   __  \\|\\   ___ \\|\\   __  \\    ",
			"\\ \\  \\  /  / | \\  \\\\\\__\\ \\  \\ \\  \\|\\  \\ \\  \\ \\  \\|\\ /\\ \\  \\|\\  \\ \\  \\|\\  \\ \\  \\|\\  \\ \\  \\_|\\ \\ \\  \\|\\  \\   ",
			" \\ \\  \\/  / / \\ \\  \\\\|__| \\  \\ \\   __  \\ \\  \\ \\   __  \\ \\  \\\\\\  \\ \\   _  _\\ \\  \\\\\\  \\ \\  \\ \\\\ \\ \\   __  \\  ",
			"  \\ \\    / /   \\ \\  \\    \\ \\  \\ \\  \\ \\  \\ \\  \\ \\  \\|\\  \\ \\  \\\\\\  \\ \\  \\\\  \\\\ \\  \\\\\\  \\ \\  \\_\\\\ \\ \\  \\ \\  \\ ",
			"   \\ \\__/ /     \\ \\__\\    \\ \\__\\ \\__\\ \\__\\ \\__\\ \\_______\\ \\_______\\ \\__\\\\ _\\\\ \\_______\\ \\_______\\ \\__\\ \\__\\",
			"    \\|__|/       \\|__|     \\|__|\\|__|\\|__|\\|__|\\|_______|\\|_______|\\|__|\\|__|\\|_______|\\|_______|\\|__|\\|__|",
			""
		},
		{
			" ________  ________  ___  ___  ________  _______   ________   ___  __    ________                          ",
			"|\\   ___ \\|\\   __  \\|\\  \\|\\  \\|\\   ___ \\|\\  ___ \\ |\\   ___  \\|\\  \\|\\  \\ |\\   __  \\                         ",
			"\\ \\  \\_|\\ \\ \\  \\|\\  \\ \\  \\\\\\  \\ \\  \\_|\\ \\ \\   __/|\\ \\  \\\\ \\  \\ \\  \\/  /|\\ \\  \\|\\  \\                        ",
			" \\ \\  \\ \\\\ \\ \\   _  _\\ \\  \\\\\\  \\ \\  \\ \\\\ \\ \\  \\_|/_\\ \\  \\\\ \\  \\ \\   ___  \\ \\  \\\\\\  \\                       ",
			"  \\ \\  \\_\\\\ \\ \\  \\\\  \\\\ \\  \\\\\\  \\ \\  \\_\\\\ \\ \\  \\_|\\ \\ \\  \\\\ \\  \\ \\  \\\\ \\  \\ \\  \\\\\\  \\                      ",
			"   \\ \\_______\\ \\__\\\\ _\\\\ \\_______\\ \\_______\\ \\_______\\ \\__\\\\ \\__\\ \\__\\\\ \\__\\ \\_______\\                     ",
			"    \\|_______|\\|__|\\|__|\\|_______|\\|_______|\\|_______|\\|__| \\|__|\\|__| \\|__|\\|_______|                     ",
			""
		},
		{
			" ________  ___  __    ________  ________  ___      ___ _______  _________  ________                        ",
			"|\\   ____\\|\\  \\|\\  \\ |\\   __  \\|\\   __  \\|\\  \\    /  /|\\  ___ \\|\\___   ___\\\\   ____\\                       ",
			"\\ \\  \\___|\\ \\  \\/  /|\\ \\  \\|\\  \\ \\  \\|\\  \\ \\  \\  /  / | \\   __/\\|___ \\  \\_\\ \\  \\___|_                      ",
			" \\ \\_____  \\ \\   ___  \\ \\   _  _\\ \\   __  \\ \\  \\/  / / \\ \\  \\_|/__  \\ \\  \\ \\ \\_____  \\                     ",
			"  \\|____|\\  \\ \\  \\\\ \\  \\ \\  \\\\  \\\\ \\  \\ \\  \\ \\    / /   \\ \\  \\_|\\ \\  \\ \\  \\ \\|____|\\  \\                    ",
			"    ____\\_\\  \\ \\__\\\\ \\__\\ \\__\\\\ _\\\\ \\__\\ \\__\\ \\__/ /     \\ \\_______\\  \\ \\__\\  ____\\_\\  \\                   ",
			"   |\\_________\\|__| \\|__|\\|__|\\|__|\\|__|\\|__|\\|__|/       \\|_______|   \\|__| |\\_________\\                  ",
			"   \\|_________|                                                              \\|_________|                  "
		}
	};

    wclear(win);



    for (int name = 0; name < 3; name++)
    {
        for (int row = 0; row < 8; row++)
        {
            for (unsigned long index = 0; index < strlen(text[name][row]); index++)
            {
                mvwprintw(win, maxY / 2 - 16 + name * 10 + row, maxX / 2 - 53, text[name][row]);
            }
        }
    }
    refresh();
    while(getch() != 'r')
    {
        usleep(TIMEOUT * 1000);
    }
    clear();
}
